var datagridSortable;$(document).on("change","select[data-autosubmit]",function(){return $(this).closest("form").submit()}).on("change","input[data-autosubmit], textarea[data-autosubmit]",function(t){var e,a;return a=t.which||t.keyCode||0,13!==a&&(a>=9&&40>=a||a>=112&&123>=a)?void 0:(clearTimeout(window.datagrid_autosubmit_timer),e=$(this),window.datagrid_autosubmit_timer=setTimeout(function(t){return function(){return e.closest("form").submit()}}(this),200))}).on("keyup","input[data-autosubmit], textarea[data-autosubmit]",function(t){var e,a;return a=t.which||t.keyCode||0,13!==a&&(a>=9&&40>=a||a>=112&&123>=a)?void 0:(clearTimeout(window.datagrid_autosubmit_timer),e=$(this),window.datagrid_autosubmit_timer=setTimeout(function(t){return function(){return e.closest("form").submit()}}(this),200))}),document.addEventListener("change",function(t){var e,a,r,i,d,n,o,s,l;if(r=t.target.getAttribute("data-check"),r&&(e=document.querySelector(".datagrid-"+r+" input[data-check]:checked"),l=document.querySelector(".datagrid-"+r+' select[name="group_action[group_action]"]'),l&&(e?l.disabled=!1:(l.disabled=!0,l.value="")),a=new Event("change",{bubbles:!0}),l&&l.dispatchEvent(a)),r=t.target.getAttribute("data-check-all")){for(n=document.querySelectorAll("input[type=checkbox][data-check-all-"+r+"]"),s=[],i=0,o=n.length;o>i;i++)d=n[i],d.checked=t.target.checked,a=new Event("change",{bubbles:!0}),s.push(d.dispatchEvent(a));return s}}),window.datagridSerializeUrl=function(t,e){var a=[];for(var r in t)if(t.hasOwnProperty(r)){var i=e?e+"["+r+"]":r,d=t[r];d&&a.push("object"==typeof d?window.datagridSerializeUrl(d,i):encodeURIComponent(i)+"="+encodeURIComponent(d))}return a.join("&")},datagridSortable=function(){return $(".datagrid [data-sortable]").sortable({handle:".handle-sort",items:"tr",update:function(t,e){var a,r;return a=$(this).sortable("serialize",{key:"sort[]",attribute:"data-id",expression:/(.+)/}),r=$(this).data("sortable-url"),r=r.match(/\?/)?r+"&"+a:r+"?"+a,$.nette.ajax({type:"GET",url:r,error:function(t,e,a){return alert(t.statusText)}})}}),$(".datagrid .datagrid-tree[data-sortable-tree]").sortable({handle:".handle-sort",items:".datagrid-tree-item",connectedWith:".datagrid .datagrid-tree[data-sortable-tree]",update:function(t,e){var a,r;return a=$(this).sortable("serialize",{key:"sort[]",attribute:"data-id",expression:/(.+)/}),r=$(this).data("sortable-url"),r=r.match(/\?/)?r+"&"+a:r+"?"+a,$.nette.ajax({type:"GET",url:r,error:function(t,e,a){return console.log(t.statusText),alert(t.statusText)}})}})},datagridSortable(),$.nette.ext("datagrid.happy",{success:function(){return window.happy.reset()}}),$.nette.ext("datagrid.sortable",{success:function(){return datagridSortable()}}),$.nette.ext("datagrid.forms",{success:function(){return $(".datagrid").find("form").each(function(){return window.Nette.initForm(this)})}}),$.nette.ext("datagrid.url",{success:function(t){var e,a,r,i;return t._datagrid_url&&window.history.pushState?(e=window.location.protocol+"//"+window.location.host,a=window.location.pathname,r=window.datagridSerializeUrl(t.state).replace(/&+$/gm,""),i=r?e+a+"?"+r.replace(/\&*$/,""):e+a,i+=window.location.hash,window.history.pushState({path:i},"",i)):void 0}}),$.nette.ext("datagrid.confirm",{before:function(t,e){var a;return e.nette&&(a=e.nette.el.data("confirm"))?confirm(a):void 0}}),$(document).on("click",".datagrid [data-toggle-detail]",function(){var t,e,a;return e=$(this).attr("data-toggle-detail"),t=$(this).attr("data-toggle-detail-grid"),a=$("."+t+" .item-detail-"+e)}),$.nette.ext("datargid.item_detail",{before:function(t,e){var a,r;return e.nette&&e.nette.el.attr("data-toggle-detail")?(a=e.nette.el.attr("data-toggle-detail"),r=$(".item-detail-"+a),r.hasClass("loaded")?r.find(".item-detail-content").size()?(r.hasClass("toggled")?r.find(".item-detail-content").slideToggle("fast",function(t){return function(){return r.toggleClass("toggled")}}(this)):(r.toggleClass("toggled"),r.find(".item-detail-content").slideToggle("fast")),!1):(r.removeClass("toggled"),!0):r.addClass("loaded")):void 0},success:function(t){var e,a;return t._datagrid_toggle_detail?(e=t._datagrid_toggle_detail,a=$(".item-detail-"+e),a.toggleClass("toggled"),a.find(".item-detail-content").slideToggle("fast")):void 0}}),$.nette.ext("datagrid.tree",{before:function(t,e){var a;return e.nette&&e.nette.el.attr("data-toggle-tree")&&(e.nette.el.toggleClass("toggle-rotate"),a=e.nette.el.closest(".datagrid-tree-item").find(".datagrid-tree-item-children").first(),a.hasClass("loaded"))?(a.slideToggle("fast"),!1):!0},success:function(t){var e,a,r,i,d,n,o;if(t._datagrid_tree){r=t._datagrid_tree,e=$(".datagrid-tree-item[data-id="+r+"]").find(".datagrid-tree-item-children").first(),e.addClass("loaded"),d=t.snippets;for(i in d)n=d[i],a=$(n),o=$('<div class="datagrid-tree-item" id="'+i+'">'),o.attr("data-id",a.attr("data-id")),o.append(a),e.append(o);return e.addClass("loaded"),e.slideToggle("fast"),$.nette.load()}}}),$(document).on("click","[data-datagrid-editable-url]",function(t){var e,a,r,i,d,n,o,s;return e=$(this),e.hasClass("editing")?void 0:(e.addClass("editing"),s=e.html().trim().replace("<br>","\n"),e.data("value",s),o=$('<textarea class="form-control">'+s+"</textarea>"),i=parseInt(e.css("padding").replace(/[^-\d\.]/g,""),10),a=e.outerHeight(),n=a-i,d=Math.round(parseFloat(e.css("line-height"))),r=(a-2*i)/d,o.attr("rows",Math.round(r)),e.removeClass("edited"),e.html(o),e.find("textarea").focus().on("blur",function(){return s=$(this).val(),s!==e.data("value")&&$.nette.ajax({url:e.data("datagrid-editable-url"),data:{value:s},method:"POST"}).success(function(){return e.addClass("edited")}),e.removeClass("editing"),e.html(s)}))});